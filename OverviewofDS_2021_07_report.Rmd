---
title: "データ科学概観 第７回 レポート問題"
author: "中野直人<br>京都大学国際高等教育院附属データ科学イノベーション教育研究センター"
date: "2021/6/13"
output: 
  html_document:
    code_folding: hide
    highlight: "zenburn"
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T)
library(DT)
```


---

<h3> 氏名：＜氏名を記入すること＞</h3>
<h3> 所属研究科：＜研究科名を記入すること＞</h3>
<h3> 学年：＜学年を記入すること＞</h3>
<h3> 学生番号：＜学生番号を記入すること＞</h3>

---

# 分散分析について講義で習ったことを演習しレポートとして提出しましょう

この Rmd ファイルは穴開きになっています．必要事項を自分で記入して完成させましょう

記入毎に Ctrl + s でこまめに保存すること

Rmd ファイルの出力は Knit を押して確認すると良い

---

## 提出方法
作業を完了させたこの Rmd ファイルと Knit してつくった html ファイルを PandA から提出すること

提出要領は PandA の「課題」を確認すること

### 注意

Rのコードチャンク以外にも記入すべきところがあるので，細部まできちんと確認すること

---

## レポート問題

（参考：実践生物統計学，東京大学生物測定学研究室編，2004）

圃場試験で栽培条件の影響を調べたい．水稲の９品種をそれぞれ６区画の水田で栽培したときのアール当たりの玄米重量は以下のとおりであった．

| 品種 |   A1 | A2   | A3   | B1   | B2   | C    | D1   | D2   | D3   |
|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|
|      | 34.3	| 33.5 | 35.2	| 36.0 | 37.3	|	38.3 | 35.1	| 36.2 | 34.6	| 
|      | 35.9	| 35.2 | 36.5	| 37.5 | 38.5	|	38.0 | 37.0	| 38.0 | 35.5	| 
|      | 36.8	| 36.1 | 37.9	| 38.1 | 39.4	|	36.8 | 38.6	| 39.9 | 36.4	| 
|      | 37.4	| 34.8 | 38.6	| 39.5 | 40.5	|	37.4 | 36.5	| 37.9 | 37.8	| 
|      | 36.0 | 35.3 | 37.1	| 38.6 | 40.1	|	35.9 | 38.4	| 39.1 | 35.9	| 
|      | 37.0	| 36.5 | 38.1	| 36.9 | 38.8	|	36.6 | 35.7	| 37.5 | 35.6	| 

1. 収穫量の上のデータに対して，品種によって差があるかどうかの分散分析を有意水準 5% で行なえ．
2. 多重比較を行い，有意な差がみとめられる品種の組を求めよ．

ただし，以下の設問のとおりにおこなうこと．

---

### 検定の設定

帰無仮説 $H_0$ はどうすべきか

有意水準 $\alpha=0.05$ で一元配置分散分析をおこなう

---

### データ格納を行なえ

R で標本をデータフレームとして格納せよ


```{r}
# groupA1, groupA2, groupA3, ... , groupD3 までのデータを格納せよ



# data frame を構成し，DTライブラリを用いて描画せよ



# plot


```

---

### 各パラメータを代入せよ

一元配置分散分析で用いるパラメータの設定をおこなえ

```{r}
# 全データを格納する配列 data をつくれ



# 総標本サイズ N を計算せよ



# 各群の標本サイズを計算せよ



# 群の数をmに代入せよ


```

---

### 平均の計算をせよ

各群の平均を計算せよ
```{r}
# 群内平均


```

総平均を計算せよ
```{r}
# 総平均


```

---

### 平方和の計算をせよ

群内平方和と群間平方和をそれぞれ計算せよ
```{r}
# 各群の平方和を計算せよ



# 群内平方和 SSW



# 群間平方和 SSA


```

---

### 総平方和を計算して確認せよ

```{r}
# 総平方和 SS を計算せよ


# 総平方和が群内平方和と群間平方和の和になっていることを確認せよ


```

---

### 平均平方の計算を計算せよ

```{r}
# 群内平均平方 MSW を計算せよ



# 群間平均平方 MSA を計算せよ



# 総平均平方 MS を計算せよ


```

---

### $F$ 統計量を計算せよ
```{r}
# F統計量 Fstar を計算せよ


```

---

### 棄却限界を求めよ
```{r}
# F(m-1, N-m) の上側5％点 F0 を計算せよ


```

---

### 検定の結果を述べよ

```この部分に検定の結果を述べよ```



---

### 分散分析表を作成せよ

上で計算した値を下の表に（手入力はダサいけど）埋めて，分散分析を完成させよ

| 変動要因      | 平方和          | 自由度 $\mathrm{df}$ | 平均平方        | 分散比 $F$                    |
|:--------------|:----------------|:---------------------|:----------------|:------------------------------|
|群間変動(処理) | $\mathrm{SS_A}$ | $m-1$                | $\mathrm{MS_A}$ | $\mathrm{MS_A}/\mathrm{MS_W}$ |
|群内変動(誤差) | $\mathrm{SS_W}$ | $N-m$                | $\mathrm{MS_W}$ |                               |
|全体           | $\mathrm{SS}$   | $N-1$                | $\mathrm{MS_T}$ |                               |

---

### 検算

R の aov 関数を用いて良いので上で行った計算を検算せよ

```{r}
# 群のラベルを表す配列 group を作成せよ


# group をカテゴリカル配列に変更せよ


# aov の結果を result に格納せよ


# aov の結果の要約を出力せよ


```


---

### Tukey HSD 検定を行え

群の平均値に統計的有意な差があるかどうかを調べるための多重比較を Tukey HSD 法を用いて行え

有意水準を0.05とする

```{r}
# 各群の箱ひげ図を描画し，各群の要約統計量を可視化せよ


# TukeyHSD 関数で多重比較を行い，結果を THSD に格納せよ


```

帰無仮説の下でどの組が有意水準以下の出現確率となるか調べよ

```{r}
# 有意水準以下となる有意確率を出す群の組を表示せよ


```

```Tukey HSD 検定の結果をここに述べよ```

きちんと元のデータセットの群の名称を用いて記述すること


---

<div style="text-align: right">**以上**</div>
